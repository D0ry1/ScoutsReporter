<UserControl x:Class="ScoutsReporter.Views.TrainingReportView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <!-- Toolbar -->
        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="4">
            <Button Content="Run Report" Command="{Binding RunReportCommand}"
                    IsEnabled="{Binding IsRunning, Converter={StaticResource InverseBoolConverter}}"
                    Padding="12,6" Margin="0,0,8,0" />
            <Button Content="Cancel" Command="{Binding RunReportCancelCommand}"
                    Visibility="{Binding IsRunning, Converter={StaticResource BoolToVisibilityConverter}}"
                    Padding="12,6" Margin="0,0,8,0" />
            <Button Content="Export CSV" Command="{Binding ExportCsvCommand}"
                    IsEnabled="{Binding IsRunning, Converter={StaticResource InverseBoolConverter}}"
                    Padding="12,6" Margin="0,0,8,0" />
            <Button Content="Export Excel" Command="{Binding ExportExcelCommand}"
                    IsEnabled="{Binding IsRunning, Converter={StaticResource InverseBoolConverter}}"
                    Padding="12,6" Margin="0,0,16,0" />
            <TextBox Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}"
                     Width="200" Padding="4,4" VerticalAlignment="Center"
                     Margin="0,0,8,0" />
            <TextBlock Text="Search" VerticalAlignment="Center"
                       Foreground="#9E9E9E" FontSize="11" Margin="0,0,16,0" />
            <TextBlock Text="{Binding ProgressText}" VerticalAlignment="Center"
                       Foreground="#757575" FontSize="11" />
        </StackPanel>

        <!-- DataGrid - uses DataView for dynamic columns -->
        <DataGrid Grid.Row="1" ItemsSource="{Binding ReportData}"
                  AutoGenerateColumns="True" IsReadOnly="True"
                  CanUserSortColumns="True" CanUserReorderColumns="True"
                  GridLinesVisibility="Horizontal" AlternatingRowBackground="#FAFAFA"
                  HeadersVisibility="Column" SelectionMode="Single"
                  HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto"
                  AutoGeneratingColumn="DataGrid_AutoGeneratingColumn" />

        <!-- Summary bar -->
        <Border Grid.Row="2" Background="#F3E5F5" Padding="8,4">
            <StackPanel Orientation="Horizontal">
                <TextBlock FontSize="12">
                    <Run Text="Total: " FontWeight="Bold" />
                    <Run Text="{Binding TotalMembers, Mode=OneWay}" />
                    <Run Text="  |  OK: " />
                    <Run Text="{Binding OkCount, Mode=OneWay}" Foreground="#23a950" />
                    <Run Text="  |  Need Attention: " />
                    <Run Text="{Binding AttentionCount, Mode=OneWay}" Foreground="#e22e12" />
                </TextBlock>
                <TextBlock Text="{Binding StatusText}" Margin="24,0,0,0"
                           Foreground="#616161" FontSize="11" VerticalAlignment="Center" />
            </StackPanel>
        </Border>
    </Grid>
</UserControl>
